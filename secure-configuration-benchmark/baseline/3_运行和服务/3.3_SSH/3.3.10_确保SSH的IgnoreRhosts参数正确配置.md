### 3.3.10 确保SSH的IgnoreRhosts参数正确配置

**级别：** 要求

**适用版本：** 全部

**规则说明：** 

SSH配置文件：/etc/ssh/sshd_config中的IgnoreRhosts参数指定.rhosts和.shosts文件不被用于RhostsRSAAuthentication或Host-basedAuthentication。

.rhosts、.shosts文件是一种控制系统间信任的关系的方法，如果一个系统信任另一个系统，则这个系统不需要密码就允许来自受信认系统的登录。这是一个老旧的配置，应当在SSH配置中明确禁用。

IgnoreRhosts参数的正确设定，可强制要求SSH在登录时必须使用密码进行验证，提高SSH登录验证的安全性。

**规则影响：**

配置生效后，受信任的系统不可免密登录服务器

**检查方法：**

确保SSH IgnoreRhosts参数正确配置。
1. 执行以下命令，验证SSH的IgnoreRhosts配置是否正确（同时满足如下两个命令行的检查）：

 ```
# sshd -T -C user=root -C host="$(hostname)" -C addr="$(grep $(hostname) /etc/hosts | awk '{print $1}')" | grep ignorerhosts
ignorerhosts yes
# grep -Ei '^\s*ignorerhosts\s+no\b' /etc/ssh/sshd_config
Nothing is returned
 ```

**修复方法：**

对 /etc/ssh/sshd_config配置文件的IgnoreRhosts参数进行配置。

1. 编辑/etc/ssh/sshd_config配置文件，修改IgnoreRhosts参数，或添加以下代码，对IgnoreRhosts参数进行配置：

```
# vim /etc/ssh/sshd_config
IgnoreRhosts yes
# systemctl restart sshd
```
### 3.5.10 确保丢弃伪造的ICMP报文，不记录日志

**级别：** 要求

**适用版本：** 全部

**规则说明：**

将icmp_ignore_bogus_error_responses设置为1可以防止内核记录广播重复数据包的响应，从而避免文件系统填充无用的日志信息。

一些攻击者会发送违反RFC-1122的ICMP报文，并试图用大量无用的错误信息填充日志文件系统。

**规则影响：**

系统丢弃伪造的ICMP报文，不记录日志

**检查方法：**

输入以下命令并检查相应的命令返回是否为1：

```bash
# sysctl net.ipv4.icmp_ignore_bogus_error_responses
net.ipv4.icmp_ignore_bogus_error_responses = 1
# grep "net.ipv4.icmp_ignore_bogus_error_responses" /etc/sysctl.conf /etc/sysctl.d/*
net.ipv4.icmp_ignore_bogus_error_responses = 1
```

**修复方法：**

输入丢弃伪造的ICMP报文规则的命令：

```bash
# sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
# sysctl -w net.ipv4.route.flush=1
```

修改/etc/sysctl.conf文件，添加或修改配置：

```bash
net.ipv4.icmp_ignore_bogus_error_responses = 1
```
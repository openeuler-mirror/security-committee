### 3.4.1 确保crontab不能执行低权限用户可写的脚本

**级别：** 要求

**适用版本：** 全部

**规则说明：** 

crontab 是系统用来执行定时任务的配置文件，配置文件路径为/etc/crontab。管理员用户会根据实际的业务需要自行定义定时任务，操作系统会自动执行该任务。所以crontabs配置文件中的配置脚本应该只有root可写，不能配置低权限用户可写的脚本，若配置了低权限用户可写的脚本则该用户可以通过修改该脚本实现提权操作。

**规则影响：**

无

**检查方法：**

检查crontabs配置文件/etc/crontab，检查特权程序是否为低权限用户可写。

```
# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
  *  *  *  *  * user-name  /bin/xxx.sh
# ll /bin/xxx.sh
-rw-------. 1 root root 451 Mar 27 17:00 /bin/xxx.sh
```

**修复方法：**

例如一个/etc/crontab配置文件中的脚本为低权限用户可写，则需要根据实际的业务场景进行修复：

- 修复方法1

  修改/etc/crontab配置文件中的脚本的文件权限，去除掉低特权用户的可写权限以防止该用户实现提权操作。

- 修复方法2

  修改/etc/crontab配置文件删除低权限用户可配置的脚本文件，防止低权限用户实现提权操作。
### 4.2.2 确保系统认证相关事件日志已记录

**级别：** 要求

**适用版本：** 全部

**规则说明：** 

必须记录系统认证相关的事件，以便帮助分析用户登录、root权限使用以及监视系统的可疑动作等情况。

不记录系统认证相关事件日志，会导致无法从日志上分析可疑的攻击动作，例如攻击者尝试猜测管理员口令，而进行的登录动作。

**规则影响：**

日志如果存在易失性存储设备，不及时对日志进行转储，可能导致日志丢失。如果存在持久性存储设备上，日志量可能非常大，不及时对日志进行转储，有可能导致日志占满当前分区，导致其他进程或系统故障风险。

**检查方法：**

检查/etc/rsyslog.conf文件中是否已经配置auth相关字段：

```bash
# grep auth /etc/rsyslog.conf | grep -v "^#"
*.info;mail.none;authpriv.none;cron.none           /var/log/messages
authpriv.*                                         /var/log/secure
```

**修复方法：**

在/etc/rsyslog.conf文件添加如下设置：

```bash
# vim /etc/rsyslog.conf
*.info;mail.none;authpriv.none;cron.none           /var/log/messages
authpriv.*                                         /var/log/secure
```

执行如下命令，重启服务，使配置生效

```bash
# systemctl restart rsyslog.service
```